<lib-header [version]="version" [title]="'surya admin'"></lib-header>

<ion-content>
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Perfil dos Usuários</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="profile-info-content">
    <ion-grid>
      <ion-row class="ion-justify-content-center">
        <ion-col size="12">
          <div class="page-header">
            <ion-button fill="clear" routerLink="/home">
              <ion-icon name="arrow-back-outline" slot="start"></ion-icon>
              Voltar
            </ion-button>
            <h2>Informações de Perfil</h2>
            <div class="header-buttons">
              <ion-button fill="solid" (click)="fetchUsers()">
                <ion-icon name="refresh-outline" slot="start"></ion-icon>
                Atualizar
              </ion-button>
            </div>
          </div>

          <!-- Search Field -->
          <div class="search-container">
            <ion-searchbar
              [(ngModel)]="searchTerm"
              (ionInput)="onSearchInput($event)"
              placeholder="Buscar por nome, email, ID ou status do perfil..."
              show-clear-button="focus"
              debounce="300">
            </ion-searchbar>
          </div>
        </ion-col>
      </ion-row>

      <ion-row *ngIf="loading" class="ion-justify-content-center">
        <ion-col size="12" class="ion-text-center">
          <ion-spinner></ion-spinner>
          <p>Carregando usuários...</p>
        </ion-col>
      </ion-row>

      <ion-row *ngIf="error" class="ion-justify-content-center">
        <ion-col size="12">
          <ion-card color="danger">
            <ion-card-content>
              <ion-icon name="alert-circle-outline"></ion-icon>
              <p>{{ error }}</p>
              <ion-button fill="outline" color="light" (click)="fetchUsers()">
                Tentar Novamente
              </ion-button>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>

      <ion-row *ngIf="!loading && !error">
        <ion-col size="12">
          <ion-card *ngFor="let user of filteredUsers" class="user-card">
            <ion-card-header>
              <ion-card-title>
                <ion-icon name="person-outline"></ion-icon>
                {{ user.name }}
              </ion-card-title>
              <ion-card-subtitle>
                <ion-badge [color]="getStatusColor(user.profile_status)">
                  {{ translateProfileStatus(user.profile_status) }}
                </ion-badge>
              </ion-card-subtitle>
            </ion-card-header>

            <ion-card-content>
              <ion-grid>
                <ion-row>
                  <ion-col size-md="6" size="12">
                    <div class="user-info">
                      <p><strong>ID:</strong> {{ user.user_id }}</p>
                      <p><strong>Nome:</strong> {{ user.name }}</p>
                      <p><strong>Email:</strong> {{ user.email }}</p>
                      <p><strong>Status do Perfil:</strong> {{ translateProfileStatus(user.profile_status) }}</p>
                    </div>
                  </ion-col>
                  <ion-col size-md="6" size="12">
                    <div class="actions">
                      <ion-button color="primary" (click)="openProfileFlow(user)">
                        <ion-icon name="create-outline" slot="start"></ion-icon>
                        Editar Perfil
                      </ion-button>
                    </div>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>

          <ion-card *ngIf="filteredUsers.length === 0 && users.length > 0">
            <ion-card-content class="ion-text-center">
              <ion-icon name="search-outline" size="large"></ion-icon>
              <h3>Nenhum usuário encontrado</h3>
              <p>Nenhum usuário corresponde aos critérios de busca.</p>
            </ion-card-content>
          </ion-card>

          <ion-card *ngIf="users.length === 0">
            <ion-card-content class="ion-text-center">
              <ion-icon name="people-outline" size="large"></ion-icon>
              <h3>Nenhum usuário encontrado</h3>
              <p>Não há registros de perfis no momento.</p>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ion-content>


